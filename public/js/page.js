$(document).ready(function(){$("button#loginBtn").click(function(){var e=$("#inputEmail").val(),t=$("#inputPassword").val();if(""===e||""===t)return $("#issue").show(),$("#issue").empty(),void $("#issue").append("Please enter username and password!");var n={username:e,password:t};$.post("/console/login",n,function(e){e.success?window.location="/console/home":($("#issue").show(),$("#issue").empty(),$("#issue").append(e.msg))})})}),$(document).ready(function(){var e=window.location.pathname,t=e.split("/"),n=parseInt(t[2]),a=$("#typeRadioVal").html();"oldmovie"===a?$("#oldmovieRadio").prop("checked",!0):"newmovie"===a&&$("#newmovieRadio").prop("checked",!0),$("#photoForm").hide(),$("#profileImg").click(function(){$("#fileInput").trigger("click")}),$("#fileInput").change(function(){var e=$("#fileInput");if(e[0].files[0]){var t=new FileReader;t.onload=function(e){$("#profileImg").attr("src",e.target.result)},t.readAsDataURL(e[0].files[0])}}),$("button#modalImgUpload").click(function(){$("#issueModal").hide();var e=$("#fileInput"),t=$("#captionInput");return 0===e[0].files.length||""===t.val()?($("#issueModal").show(),$("#issueModal").empty(),void $("#issueModal").append("Please select image and enter caption to <b>Upload</b>!")):void $.post("/article/"+n+"/captions",{caption:t.val()},function(e){e.success&&$("#photoForm").submit()})}),$("button#prevBtn").click(function(){$("#issue").hide();var e,t=$("#textInput").val(),a=$("#headInput").val(),o=$("input[name=typeInput]:checked").val();if("feature"===o?e="Feature":"oldmovie"===o?e="Old Movie":"newmovie"===o&&(e="New Movie"),""===t||""===a)return $("#issue").show(),$("#issue").empty(),void $("#issue").append("Please enter a title and text for the article before you <b>Preview</b>!");$("#previewView").show(),$("#editView").hide(),$("#prevBtn").hide(),$("#editBtn").show(),$("#saveBtn").hide(),$("#window").empty(),$("#window").append(t),$("#headPrev").empty(),$("#headPrev").append(a),$("#typePrev").empty(),$("#typePrev").append(e);var r={title:a,type:o,text:t};$.post("/article/"+n,r,function(e){e.success&&i()})}),$("button#editBtn").click(function(){$("#issue").hide(),$("#previewView").hide(),$("#editView").show(),$("#prevBtn").show(),$("#editBtn").hide(),$("#saveBtn").show()});$("button#imgUploadBtn").click(function(){$("#issue").hide();var e=$("#textInput").val(),t=$("#headInput").val(),a=$("input[name=typeInput]:checked").val();if(""===e||""===t)return setTimeout(function(){$("#closeModalBtn").trigger("click")},1e3),$("#issue").show(),$("#issue").empty(),void $("#issue").append("Please enter a title and text for the article before you <b>Save</b>!");var o={title:t,type:a,text:e};$.post("/article/"+n,o,function(e){e.success&&i()})});var i=function(){$("#saveAlert").show(),setTimeout(function(){$("#saveAlert").fadeOut()},3e3)};$("button#saveBtn").click(function(){$("#issue").hide();var e=$("#textInput").val(),t=$("#headInput").val(),a=$("input[name=typeInput]:checked").val();if(""===e||""===t)return $("#issue").show(),$("#issue").empty(),void $("#issue").append("Please enter a title and text for the article before you <b>Save</b>!");var o={title:t,type:a,text:e};$.post("/article/"+n,o,function(e){e.success&&i()})}),$("button#submBtn").click(function(){$("#issue").hide();var e=$("#textInput").val(),t=$("#headInput").val(),a=$("input[name=typeInput]:checked").val();if(""===e||""===t)return $("#issue").show(),$("#issue").empty(),void $("#issue").append("Please enter a title and text for the article before you <b>Submit</b>!");var o={title:t,type:a,text:e};$.post("/article/"+n,o,function(e){e.success&&(i(),$.post("/article/"+n+"/submit",o,function(e){e.success&&(window.location="/console/home")}))})}),$("button#publBtn").click(function(){$("#issue").hide();var e=$("#textInput").val(),t=$("#headInput").val(),a=$("input[name=typeInput]:checked").val();if(""===e||""===t)return $("#issue").show(),$("#issue").empty(),void $("#issue").append("Please enter a title and text for the article before you <b>Publish</b>!");var o={title:t,type:a,text:e};$.post("/article/"+n,o,function(e){e.success&&(i(),$.post("/article/"+n+"/publish",o,function(e){e.success&&(window.location="/")}))})}),$("button#retractBtn").click(function(){$("#issue").hide(),$.post("/article/"+n+"/retract",function(e){e.success&&(window.location="/")})}),$("button.starBtn").click(function(e){var t=$(e.target).closest("button");if(!t.hasClass("btn-primary")){var a=t.val().split(";"),i=parseInt(a[0]),o=a[1],r={image:o,imageIndex:i};$.post("/article/"+n+"/cover",r,function(e){e.success&&($(".starBtn").removeClass("btn-primary"),t.addClass("btn-primary"))})}})}),function(e,t){function n(t){var n=e.URL||e.webkitURL,a=e.Blob,i=e.Worker;if(!(n&&a&&i&&t))return null;var o=new a([t]),r=new i(n.createObjectURL(o));return r}function a(e,t){function n(e){for(var t=[],n=e.clipboardData||{},i=n.items||[],o=0;o<i.length;o++){var r=i[o].getAsFile();if(r){var s=new RegExp("/(.*)").exec(r.type);if(!r.name&&s){var d=s[1];r.name="clipboard"+o+"."+d}t.push(r)}}t.length&&(u(e,t,a),e.preventDefault(),e.stopPropagation())}if(x.enabled){var a=p(p({},x.opts),t);e.addEventListener("paste",n,!1)}}function i(e,t){function n(t){u(t,e.files,i)}function a(e){e.stopPropagation(),e.preventDefault(),u(e,e.dataTransfer.files,i)}if(x.enabled){var i=p(p({},x.opts),t);e.addEventListener("change",n,!1),e.addEventListener("drop",a,!1)}}function o(e,n){function a(e){m=!1}function i(e){m=!0}function o(e){e.dataTransfer.files&&e.dataTransfer.files.length&&(e.stopPropagation(),e.preventDefault())}function r(e){return function(){m||e.apply(this,arguments)}}function s(t){t.stopPropagation(),t.preventDefault(),h&&$(e,h),u(t,t.dataTransfer.files,v)}function d(t){t.stopPropagation(),t.preventDefault(),h&&f(e,h)}function l(t){h&&$(e,h)}function c(t){t.stopPropagation(),t.preventDefault(),h&&f(e,h)}if(x.enabled){var v=p(p({},x.opts),n),h=v.dragClass,m=!1;e.addEventListener("dragenter",r(d),!1),e.addEventListener("dragleave",r(l),!1),e.addEventListener("dragover",r(c),!1),e.addEventListener("drop",r(s),!1),t.body.addEventListener("dragstart",i,!0),t.body.addEventListener("dragend",a,!0),t.body.addEventListener("drop",o,!1)}}function r(e,t){for(var n=0;n<e.length;n++){var a=e[n];a.extra={nameNoExtension:a.name.substring(0,a.name.lastIndexOf(".")),extension:a.name.substring(a.name.lastIndexOf(".")+1),fileID:n,uniqueID:I(),groupID:t,prettySize:v(a.size)}}}function s(e,t,n){for(var a in t)if(e.match(new RegExp(a)))return"readAs"+t[a];return"readAs"+n}function u(e,t,a){function i(){d.ended=new Date,a.on.groupend(d)}function o(){0===--u&&i()}var u=t.length,d={groupID:B(),files:t,started:new Date};if(x.output.push(d),r(t,d.groupID),a.on.groupstart(d),!t.length)return void i();var l,p=y&&m;p&&(l=n(w),l.onmessage=function(e){var t=e.data.file,n=e.data.result;t.extra||(t.extra=e.data.extra),t.extra.ended=new Date,a.on["error"===n?"error":"load"]({target:{result:n}},t),o()}),Array.prototype.forEach.call(t,function(t){if(t.extra.started=new Date,a.accept&&!t.type.match(new RegExp(a.accept)))return a.on.skip(t),void o();if(a.on.beforestart(t)===!1)return a.on.skip(t),void o();var n=s(t.type,a.readAsMap,a.readAsDefault);if(l)l.postMessage({file:t,extra:t.extra,readAs:n});else{var i=new h;i.originalEvent=e,b.forEach(function(e){i["on"+e]=function(n){("load"==e||"error"==e)&&(t.extra.ended=new Date),a.on[e](n,t),"loadend"==e&&o()}}),i[n](t)}})}function d(){var e=n(g);e&&(e.onmessage=function(e){m=e.data},e.postMessage({}))}function l(){}function p(e,t){for(var n in t)t[n]&&t[n].constructor&&t[n].constructor===Object?(e[n]=e[n]||{},arguments.callee(e[n],t[n])):e[n]=t[n];return e}function c(e,t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)}function f(e,t){c(e,t)||(e.className=e.className?[e.className,t].join(" "):t)}function $(e,t){if(c(e,t)){var n=e.className;e.className=n.replace(new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)","g")," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}}function v(e){var t=["bytes","kb","MB","GB","TB","PB"],n=Math.floor(Math.log(e)/Math.log(1024));return(e/Math.pow(1024,Math.floor(n))).toFixed(2)+" "+t[n]}var h=e.FileReader,m=!1,w="self.addEventListener('message', function(e) { var data=e.data; try { var reader = new FileReaderSync; postMessage({ result: reader[data.readAs](data.file), extra: data.extra, file: data.file})} catch(e){ postMessage({ result:'error', extra:data.extra, file:data.file}); } }, false);",g="onmessage = function(e) { postMessage(!!FileReaderSync); };",b=["loadstart","progress","load","abort","error","loadend"],y=!1,x=e.FileReaderJS={enabled:!1,setupInput:i,setupDrop:o,setupClipboard:a,setSync:function(e){y=e,y&&!m&&d()},getSync:function(){return y&&m},output:[],opts:{dragClass:"drag",accept:!1,readAsDefault:"DataURL",readAsMap:{},on:{loadstart:l,progress:l,load:l,abort:l,error:l,loadend:l,skip:l,groupstart:l,groupend:l,beforestart:l}}};if("undefined"!=typeof jQuery&&(jQuery.fn.fileReaderJS=function(e){return this.each(function(){jQuery(this).is("input")?i(this,e):o(this,e)})},jQuery.fn.fileClipboard=function(e){return this.each(function(){a(this,e)})}),h){var B=function(e){return function(){return e++}}(0),I=function(e){return function(){return e++}}(0);x.enabled=!0}}(this,document),$(document).ready(function(){var e=window.location.pathname;"/console/home"===e||"/features"===e?$("#navbar1").addClass("active"):"/author/profile"===e||"/movies"===e?$("#navbar2").addClass("active"):"/events"===e?$("#navbar3").addClass("active"):(-1!==e.indexOf("draft")||"/about"===e)&&$("#navbar4").addClass("active")}),$(document).ready(function(){$("#photoForm").hide(),$("#updateProfile").hide();var e,t;$("#fileInput").change(function(){$("#photoForm").submit()}),$("button#editBtn").click(function(){$("#editBtn").hide(),$("#pwBtn").hide(),$("#profileName").hide(),$("#profileBio").hide(),$("#inputName").show(),$("#inputBio").show(),$("#updateProfile").show(),e=$("#inputName").val(),t=$("#inputBio").val()}),$("button#updateProfile").click(function(){var n=$("#inputName").val(),a=$("#inputBio").val();if(""===n||""===a)return $("#issue").show(),$("#issue").empty(),void $("#issue").append("You really should have a name and bio!");if(n!==e||a!==t){$("#profileName").empty(),$("#profileName").append(n),$("#profileBio").empty(),$("#profileBio").append(a);var i={name:n,bio:a};$.post("/author/profile/description",i)}$("#editBtn").show(),$("#pwBtn").show(),$("#profileName").show(),$("#profileBio").show(),$("#issue").hide(),$("#inputName").hide(),$("#inputBio").hide(),$("#updateProfile").hide()});var n=function(){$("#saveAlert").show(),setTimeout(function(){$("#saveAlert").fadeOut()},3e3)};$("#pwcBtn").click(function(){$("#issueModal").hide();var e=$("#oldpw").val(),t=$("#newpw1").val(),a=$("#newpw2").val();if(""!==e&&""!==t&&""!==a){if(t!==a)return $("#issueModal").show(),$("#issueModal").empty(),void $("#issueModal").append("New passwords do not match up!");var i={oldpassword:e,newpassword:t};$.post("/author/password",i,function(e){return e.success?void setTimeout(function(){$("#closeModalBtn").trigger("click"),n()},500):($("#issueModal").show(),$("#issueModal").empty(),void $("#issueModal").append(e.msg))})}})});