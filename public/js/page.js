$(document).ready(function(){$("button#loginBtn").click(function(){var e=$("#inputEmail").val(),t=$("#inputPassword").val();if(""===e||""===t)return $("#issue").show(),$("#issue").empty(),void $("#issue").append("Please enter username and password!");var a={username:e,password:t};$.post("/console/login",a,function(e){e.success?window.location="/console/home":($("#issue").show(),$("#issue").empty(),$("#issue").append(e.msg))})}),$("button#signupBtn").click(function(){var e=$("#inputUser").val(),t=$("#inputName").val(),a=$("#inputEmail").val(),n=$("#inputPassword").val(),i=$("#inputPasswordConfirm").val();if(""===e||""===a||""===n||""===i||""===t)return $("#issue").show(),$("#issue").empty(),void $("#issue").append("Please fill out all fields!");if(n!==i)return $("#issue").show(),$("#issue").empty(),void $("#issue").append("Passwords do not match!");var s={username:e,name:t,password:n,email:a};$.post("/author/create",s,function(e){$("#issue").show(),$("#issue").empty(),e.success?($("#issue").removeClass("alert-danger"),$("#issue").addClass("alert-success")):($("#issue").removeClass("alert-success"),$("#issue").addClass("alert-danger")),$("#issue").append(e.msg)})})}),$(document).ready(function(){var e=window.location.pathname,t=e.split("/"),a=parseInt(t[2]),n=$("#typeRadioVal").html();"oldmovie"===n?$("#oldmovieRadio").prop("checked",!0):"newmovie"===n&&$("#newmovieRadio").prop("checked",!0),$("#photoForm").hide(),$("#profileImg").click(function(){$("#fileInput").trigger("click")}),$("#fileInput").change(function(){var e=$("#fileInput");if(e[0].files[0]){var t=new FileReader;t.onload=function(e){$("#profileImg").attr("src",e.target.result)},t.readAsDataURL(e[0].files[0])}}),$("button#modalImgUpload").click(function(){$("#issueModal").hide();var e=$("#fileInput"),t=$("#captionInput");return 0===e[0].files.length||""===t.val()?($("#issueModal").show(),$("#issueModal").empty(),void $("#issueModal").append("Please select image and enter caption to <b>Upload</b>!")):void $.post("/article/"+a+"/captions",{caption:t.val()},function(e){e.success&&$("#photoForm").submit()})}),$("button#prevBtn").click(function(){$("#issue").hide();var e,t=$("#textInput").val(),n=$("#headInput").val(),s=$("input[name=typeInput]:checked").val();if("feature"===s?e="Feature":"oldmovie"===s?e="Old Movie":"newmovie"===s&&(e="New Movie"),""===t||""===n)return $("#issue").show(),$("#issue").empty(),void $("#issue").append("Please enter a title and text for the article before you <b>Preview</b>!");$("#previewView").show(),$("#editView").hide(),$("#prevBtn").hide(),$("#editBtn").show(),$("#saveBtn").hide(),$("#window").empty(),$("#window").append(t),$("#headPrev").empty(),$("#headPrev").append(n),$("#typePrev").empty(),$("#typePrev").append(e);var o={title:n,type:s,text:t};$.post("/article/"+a,o,function(e){e.success&&i()})}),$("button#editBtn").click(function(){$("#issue").hide(),$("#previewView").hide(),$("#editView").show(),$("#prevBtn").show(),$("#editBtn").hide(),$("#saveBtn").show()});$("button#imgUploadBtn").click(function(){$("#issue").hide();var e=$("#textInput").val(),t=$("#headInput").val(),n=$("input[name=typeInput]:checked").val();if(""===e||""===t)return setTimeout(function(){$("#closeModalBtn").trigger("click")},1e3),$("#issue").show(),$("#issue").empty(),void $("#issue").append("Please enter a title and text for the article before you <b>Save</b>!");var s={title:t,type:n,text:e};$.post("/article/"+a,s,function(e){e.success&&i()})});var i=function(){$("#saveAlert").show(),setTimeout(function(){$("#saveAlert").fadeOut()},3e3)};$("button#saveBtn").click(function(){$("#issue").hide();var e=$("#textInput").val(),t=$("#headInput").val(),n=$("input[name=typeInput]:checked").val();if(""===e||""===t)return $("#issue").show(),$("#issue").empty(),void $("#issue").append("Please enter a title and text for the article before you <b>Save</b>!");var s={title:t,type:n,text:e};$.post("/article/"+a,s,function(e){e.success&&i()})}),$("button#submBtn").click(function(){$("#issue").hide();var e=$("#textInput").val(),t=$("#headInput").val(),n=$("input[name=typeInput]:checked").val();if(""===e||""===t)return $("#issue").show(),$("#issue").empty(),void $("#issue").append("Please enter a title and text for the article before you <b>Submit</b>!");var s={title:t,type:n,text:e};$.post("/article/"+a,s,function(e){e.success&&(i(),$.post("/article/"+a+"/submit",s,function(e){e.success&&(window.location="/console/home")}))})}),$("button#publBtn").click(function(){$("#issue").hide();var e=$("#textInput").val(),t=$("#headInput").val(),n=$("input[name=typeInput]:checked").val();if(""===e||""===t)return $("#issue").show(),$("#issue").empty(),void $("#issue").append("Please enter a title and text for the article before you <b>Publish</b>!");var s={title:t,type:n,text:e};$.post("/article/"+a,s,function(e){e.success&&(i(),$.post("/article/"+a+"/publish",s,function(e){e.success&&(window.location="/")}))})}),$("button#retractBtn").click(function(){$("#issue").hide(),$.post("/article/"+a+"/retract",function(e){e.success&&(window.location="/")})}),$("button.starBtn").click(function(e){var t=$(e.target).closest("button");if(!t.hasClass("btn-primary")){var n=t.val().split(";"),i=parseInt(n[0]),s=n[1],o={image:s,imageIndex:i};$.post("/article/"+a+"/cover",o,function(e){e.success&&($(".starBtn").removeClass("btn-primary"),t.addClass("btn-primary"))})}})}),function(e,t){function a(t){var a=e.URL||e.webkitURL,n=e.Blob,i=e.Worker;if(!(a&&n&&i&&t))return null;var s=new n([t]),o=new i(a.createObjectURL(s));return o}function n(e,t){function a(e){for(var t=[],a=e.clipboardData||{},i=a.items||[],s=0;s<i.length;s++){var o=i[s].getAsFile();if(o){var r=new RegExp("/(.*)").exec(o.type);if(!o.name&&r){var l=r[1];o.name="clipboard"+s+"."+l}t.push(o)}}t.length&&(u(e,t,n),e.preventDefault(),e.stopPropagation())}if(x.enabled){var n=p(p({},x.opts),t);e.addEventListener("paste",a,!1)}}function i(e,t){function a(t){u(t,e.files,i)}function n(e){e.stopPropagation(),e.preventDefault(),u(e,e.dataTransfer.files,i)}if(x.enabled){var i=p(p({},x.opts),t);e.addEventListener("change",a,!1),e.addEventListener("drop",n,!1)}}function s(e,a){function n(e){m=!1}function i(e){m=!0}function s(e){e.dataTransfer.files&&e.dataTransfer.files.length&&(e.stopPropagation(),e.preventDefault())}function o(e){return function(){m||e.apply(this,arguments)}}function r(t){t.stopPropagation(),t.preventDefault(),h&&$(e,h),u(t,t.dataTransfer.files,v)}function l(t){t.stopPropagation(),t.preventDefault(),h&&f(e,h)}function d(t){h&&$(e,h)}function c(t){t.stopPropagation(),t.preventDefault(),h&&f(e,h)}if(x.enabled){var v=p(p({},x.opts),a),h=v.dragClass,m=!1;e.addEventListener("dragenter",o(l),!1),e.addEventListener("dragleave",o(d),!1),e.addEventListener("dragover",o(c),!1),e.addEventListener("drop",o(r),!1),t.body.addEventListener("dragstart",i,!0),t.body.addEventListener("dragend",n,!0),t.body.addEventListener("drop",s,!1)}}function o(e,t){for(var a=0;a<e.length;a++){var n=e[a];n.extra={nameNoExtension:n.name.substring(0,n.name.lastIndexOf(".")),extension:n.name.substring(n.name.lastIndexOf(".")+1),fileID:a,uniqueID:I(),groupID:t,prettySize:v(n.size)}}}function r(e,t,a){for(var n in t)if(e.match(new RegExp(n)))return"readAs"+t[n];return"readAs"+a}function u(e,t,n){function i(){l.ended=new Date,n.on.groupend(l)}function s(){0===--u&&i()}var u=t.length,l={groupID:B(),files:t,started:new Date};if(x.output.push(l),o(t,l.groupID),n.on.groupstart(l),!t.length)return void i();var d,p=y&&m;p&&(d=a(w),d.onmessage=function(e){var t=e.data.file,a=e.data.result;t.extra||(t.extra=e.data.extra),t.extra.ended=new Date,n.on["error"===a?"error":"load"]({target:{result:a}},t),s()}),Array.prototype.forEach.call(t,function(t){if(t.extra.started=new Date,n.accept&&!t.type.match(new RegExp(n.accept)))return n.on.skip(t),void s();if(n.on.beforestart(t)===!1)return n.on.skip(t),void s();var a=r(t.type,n.readAsMap,n.readAsDefault);if(d)d.postMessage({file:t,extra:t.extra,readAs:a});else{var i=new h;i.originalEvent=e,b.forEach(function(e){i["on"+e]=function(a){("load"==e||"error"==e)&&(t.extra.ended=new Date),n.on[e](a,t),"loadend"==e&&s()}}),i[a](t)}})}function l(){var e=a(g);e&&(e.onmessage=function(e){m=e.data},e.postMessage({}))}function d(){}function p(e,t){for(var a in t)t[a]&&t[a].constructor&&t[a].constructor===Object?(e[a]=e[a]||{},arguments.callee(e[a],t[a])):e[a]=t[a];return e}function c(e,t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)}function f(e,t){c(e,t)||(e.className=e.className?[e.className,t].join(" "):t)}function $(e,t){if(c(e,t)){var a=e.className;e.className=a.replace(new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)","g")," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}}function v(e){var t=["bytes","kb","MB","GB","TB","PB"],a=Math.floor(Math.log(e)/Math.log(1024));return(e/Math.pow(1024,Math.floor(a))).toFixed(2)+" "+t[a]}var h=e.FileReader,m=!1,w="self.addEventListener('message', function(e) { var data=e.data; try { var reader = new FileReaderSync; postMessage({ result: reader[data.readAs](data.file), extra: data.extra, file: data.file})} catch(e){ postMessage({ result:'error', extra:data.extra, file:data.file}); } }, false);",g="onmessage = function(e) { postMessage(!!FileReaderSync); };",b=["loadstart","progress","load","abort","error","loadend"],y=!1,x=e.FileReaderJS={enabled:!1,setupInput:i,setupDrop:s,setupClipboard:n,setSync:function(e){y=e,y&&!m&&l()},getSync:function(){return y&&m},output:[],opts:{dragClass:"drag",accept:!1,readAsDefault:"DataURL",readAsMap:{},on:{loadstart:d,progress:d,load:d,abort:d,error:d,loadend:d,skip:d,groupstart:d,groupend:d,beforestart:d}}};if("undefined"!=typeof jQuery&&(jQuery.fn.fileReaderJS=function(e){return this.each(function(){jQuery(this).is("input")?i(this,e):s(this,e)})},jQuery.fn.fileClipboard=function(e){return this.each(function(){n(this,e)})}),h){var B=function(e){return function(){return e++}}(0),I=function(e){return function(){return e++}}(0);x.enabled=!0}}(this,document),$(document).ready(function(){var e=window.location.pathname;"/console/home"===e||"/features"===e?$("#navbar1").addClass("active"):"/author/profile"===e||"/movies"===e?$("#navbar2").addClass("active"):"/events"===e?$("#navbar3").addClass("active"):(-1!==e.indexOf("draft")||"/about"===e)&&$("#navbar4").addClass("active")}),$(document).ready(function(){$("#photoForm").hide(),$("#updateProfile").hide();var e,t,a;$("#fileInput").change(function(){$("#photoForm").submit()}),$("button#editBtn").click(function(){$("#editBtn").hide(),$("#pwBtn").hide(),$("#profileName").hide(),$("#profileBio").hide(),$("#inputName").show(),$("#inputEmail").show(),$("#inputBio").show(),$("#updateProfile").show(),e=$("#inputName").val(),t=$("#inputEmail").val(),a=$("#inputBio").val()}),$("button#updateProfile").click(function(){var n=$("#inputName").val(),i=$("#inputEmail").val(),s=$("#inputBio").val();if(""===n||""===s||""===i)return $("#issue").show(),$("#issue").empty(),void $("#issue").append("Please fill out all the fields!");if(n!==e||s!==a||i!==t){$("#profileName").empty(),$("#profileName").append(n),$("#profileBio").empty(),$("#profileBio").append(s);var o={name:n,bio:s,email:i};$.post("/author/profile/description",o)}$("#editBtn").show(),$("#pwBtn").show(),$("#profileName").show(),$("#profileBio").show(),$("#issue").hide(),$("#inputName").hide(),$("#inputEmail").hide(),$("#inputBio").hide(),$("#updateProfile").hide()});var n=function(){$("#saveAlert").show(),setTimeout(function(){$("#saveAlert").fadeOut()},3e3)};$("#pwcBtn").click(function(){$("#issueModal").hide();var e=$("#oldpw").val(),t=$("#newpw1").val(),a=$("#newpw2").val();if(""!==e&&""!==t&&""!==a){if(t!==a)return $("#issueModal").show(),$("#issueModal").empty(),void $("#issueModal").append("New passwords do not match up!");var i={oldpassword:e,newpassword:t};$.post("/author/password",i,function(e){return e.success?void setTimeout(function(){$("#closeModalBtn").trigger("click"),n()},500):($("#issueModal").show(),$("#issueModal").empty(),void $("#issueModal").append(e.msg))})}})});